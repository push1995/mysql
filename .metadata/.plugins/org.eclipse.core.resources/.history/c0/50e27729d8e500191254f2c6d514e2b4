package javaassn;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class MySQL1 {

	
		  // JDBC driver name and database URL
		   static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";  
		   static final String DB_URL = "jdbc:mysql://localhost/user?autoReconnect=true&useSSL=false";

		   //  Database credentials
		   static final String USER = "root";
		   static final String PASS = "" ;
		   
		   public static void main(String[] args) {
		   Connection conn = null;
		   Statement stmt = null;
		   try{
			      //STEP 2: Register JDBC driver
			      Class.forName("com.mysql.jdbc.Driver");

			      //STEP 3: Open a connection
			      System.out.println("Connecting to database...");
			      conn = DriverManager.getConnection(DB_URL,USER,PASS);

			      //STEP 4: Execute a query
			      System.out.println("Creating statement...");
			      stmt = conn.createStatement();
			      String sql;
			      sql = "SELECT * FROM userdetails";
			      ResultSet rs = stmt.executeQuery(sql);

			      //STEP 5: Extract data from result set
			      while(rs.next()){
			         //Retrieve by column name
			         int id  = rs.getInt("rollno");
			         String name = rs.getString("name");
			         int marks = rs.getInt("marks");
			         
			         //Display values
			         System.out.print("Phoneno: " + phoneno + " ");
			         System.out.print("Name: " + name + " ");
			         System.out.println("Email: " + email);
			      }
			         
			        /* sql = "INSERT INTO userdetails (name, id, phoneno, email) VALUES (?,?,?,?)";
			         
			         PreparedStatement statement = conn.prepareStatement(sql);
			         statement.setString(1, "Rakshitha");
			         statement.setInt(2, "1");
			         statement.setInt(3, "9875434679");
			         statement.setString(4, "rakshi@gmail.com");
			          
			         int rowsInserted = statement.executeUpdate();
			         if (rowsInserted > 0) {
			             System.out.println("A new user was inserted successfully!");
			         }
			             
			         sql = "UPDATE Userdetails SET name=?, userstatus=?, phoneno=?, email=? WHERE id=?";
			             
			         PreparedStatement statement = conn.prepareStatement(sql);
			         statement.setString(1, "xyz");
			         statement.setString(2, "yes");
			         statement.setInt(3, "7868967596");
			         statement.setString(4, "xyz@microsoft.com");
			         statement.setInt(5, "1");
			              
			             int rowsUpdated = statement.executeUpdate();
			             if (rowsUpdated > 0) {
			                 System.out.println("An existing user was updated successfully!");
			             }
			       
			      }*/
			             rs.close();
					      stmt.close();
					      conn.close();
					   }catch(SQLException se){
					      //Handle errors for JDBC
					      se.printStackTrace();
					   }catch(Exception e){
					      //Handle errors for Class.forName
					      e.printStackTrace();
					   }finally{
					      //finally block used to close resources
					      try{
					         if(stmt!=null)
					            stmt.close();
					      }catch(SQLException se2){
					      }// nothing we can do
					      try{
					         if(conn!=null)
					            conn.close();
					      }catch(SQLException se){
					         se.printStackTrace();
					      }//end finally try
					   }//end try
					   System.out.println("Goodbye!");
					}//end main
				}//end FirstExample

